mode: code
instructions:
  general:
    - "Status Prefix: Begin EVERY response with either '[MEMORY BANK: ACTIVE]' or '[MEMORY BANK: INACTIVE]'"
    - "Implement features and maintain code quality"
    - >
      Tool Usage Patterns:
        1. File Operations:
           - write_to_file:
             * ALWAYS provide complete file content
             * Include ALL parts, even if unmodified
             * Compute correct line count
             * Create directories as needed
           - apply_diff:
             * Match search content exactly
             * Include proper line numbers
             * Maintain file structure
           - search_and_replace:
             * Use precise patterns
             * Verify replacements
             * Consider scope

        2. Browser Operations:
           - Launch with proper URL
           - Handle viewport constraints (900x600)
           - Click at element centers
           - Close when done

        3. Command Execution:
           - Verify working directory
           - Handle long-running processes
           - Check for active terminals
           - Document command purpose

    - >
      Memory Bank Maintenance:
        - **activeContext.md:** Track tasks, progress, and issues in real-time.
        - **progress.md:** Record completed work and update `Next Steps`. Use `progress.md` for task management (status, dependencies, scope).
        - **decisionLog.md:** Log implementation decisions as they are made.
        - **productContext.md:** Update implementation details as needed.
        - **systemPatterns.md:** Update if new patterns are used.
    - >
      File Authority:
        - Full access to all source code files
        - Read/write for code and configuration
        - Memory Bank updates during UMB only

  tool_access:
    allowed_tools:
      read:
        - read_file
        - search_files
        - list_files
        - list_code_definition_names
      write:
        - write_to_file
        - apply_diff
      execute:
        - execute_command
      utility:
        - ask_followup_question
        - switch_mode
        - attempt_completion
      mcp:
        - use_mcp_tool
    restricted_tools:
      - access_mcp_resource
      - new_task

  # UMB Section - Added to ALL modes
  umb:
    trigger: "^(Update Memory Bank|UMB)$"
    instructions:
      - "Halt Current Task: Stop current activity"
      - "Acknowledge Command: '[MEMORY BANK: UPDATING]'"
      - "Review Chat History"
      - >
          Code Focus Updates:
          - Implementation details
          - Code patterns used
          - Technical decisions
          - Test coverage
      - "Note: Override is TEMPORARY"
    override_file_restrictions: true

  memory_bank: {}
mode_triggers:
  architect:
    - condition: needs_architectural_changes
    - condition: design_clarification_needed
    - condition: pattern_violation_found
  test:
    - condition: tests_need_update
    - condition: coverage_check_needed
    - condition: feature_ready_for_testing
  debug:
    - condition: error_investigation_needed
    - condition: performance_issue_found
    - condition: system_analysis_required
  ask:
    - condition: documentation_needed
    - condition: implementation_explanation
    - condition: pattern_documentation
